<!DOCTYPE HTML><html lang="ru"><head>	<meta name="viewport" content="width=device-width, initial-scale=1.0">
				<meta charset="UTF-8">		
	<link rel="icon" type="image/png" sizes="32x32" href="ico/book_r.gif">  
		<link rel="stylesheet" href="styl/rst-0.css" type="text/css">	<link rel="stylesheet" href="styl/header.css" type="text/css">
		<link rel="stylesheet" href="styl/fnt-0.css" type="text/css">	<link rel="stylesheet" href="styl/slider.css" type="text/css">
		<link rel="stylesheet" href="styl/cardStyl.css" type="text/css">
	<title>BookShop-MS v.0.16.6</title></head>		<style> 
.container0{max-width:1440px;}				.container0,.sliderContainer{background-color:#F2F2F2;}
   .sliderContainer,header,footer,main{width:95%;}
	main   {margin:129px auto 0px;}
		sidebar    {background-color:#EAEAF5;height:46vw;width:30%; }				  
			.sidebarTextBlock{width:75%;height:80%;	  margin-top:10%;}
			.sidebarItem,.sibarMark{align-items:center;}   		   
			   .sibarMark{width:13%;height:50%;padding:0px 0px 3% 0px;font-size:250%;color:darkmagenta; }				
			   .sidebarItem{font-size:1vw;height:7%; }
		.goodsBlock {flex-flow:row wrap;background:white;width:73%;margin:3% 0px 0px -4%;}
		.cardContainer{width:49.6%;transition:transform;transition-duration:800ms;}
			.cardContainer:hover{transform:scale(1.1);border:.4px solid #ADD8E6;
					     box-shadow:.3vw .3vw 2px 0px #DDDDDD; }
	   .ldMoreBtnWrap{position:relative;width:20%;margin:-0.5vw auto 10%;}
 	   .ldMoreBtn{position:absolute;z-index:2;width:100%;background:floralwhite;border-color:lightgray;
		      color:dimgray;transition:background,border-radius,color;transition-duration:800ms;}
	   .ldMoreBtn:hover{background:white;color:black;border-color:blue;border-radius:1vw;}
	footer {background:magenta;height:70px;}
@media (max-width: 800px) { 
			header{height:14vw;padding:0;} 
			   .header_wrap{height:15vw;margin-top:2.5vw;}
			   .header_hoop,header{width:85vw;}	.menu{margin:0px 10px 0px 10px;}
			   .fnt_size_10{font-size:8px;} .spc_39,.spc_74,.spc_109,.spc_30{width:auto;}
			   .ico_link_container{width:15vw;}
	.slider_pic_link_box{font-weight:500;}
			main{margin:10vw auto 1vw;}			
}
@media (min-width: 1440px) {
			.slider_pic_link_pos1{top:41px;right:90px;}
		  .slider_pic_link_pos2{top:350px}
		     .slider_pic_link_box{
				box-shadow:0px 15px 17px 0px lightgray;
				font-size:20px;}
			
			.slider_pic_link_box1{width:150px; height:200px;
					      padding:90px 10px 10px 20px;}	
			.slider_pic_link_box2{width:130px; height:250px;
					      padding:110px 40px 10px 20px;}
	.sliderSwitch{width:56px;height:12px;margin:17px auto 0px;}
	sidebar    {height:700px; }
	.sidebarItem{font-size:14px;height:38px; }
}
</style><body>
<div class="container0 blok_centr"> 
<div class="header_wrap"> 
<header>
<!-- LOGO -->	
	<div class="logo fnt_size_24" title="Bookshop logotype">Bookshop</div>		
<!-- Nav MENU -->
	<div class="menu">									
	  <a href='#sidebar1' class="mnu_links spc_39 fnt_size_10" title="Books">	 Books				</a>	
	  <a href='#loadMoreAncor' class="mnu_links spc_74 fnt_size_10" title="AUDIOBooks"> AUDIOBooks			</a>	
	  <a href='#' class="mnu_links spc_109 fnt_size_10" title="STATIONERY and GIFTS">STATIONERY&nbsp;&&nbsp;GIFTS	</a>	
	  <a href='#' class="mnu_links spc_30 fnt_size_10" title="Blog page">		 Blog				</a>		  	
	</div>						
<!-- Nav Links: profile, search, client cart icons block -->			
		<div class="ico_link_container">		
			<a href='#' class="icon_link" title="client profile page">
						<img src="ico/user.svg"  type="image/svg+xml" alt='user profile' class="menu_ico">		</a>	
			<a href='#' class="icon_link" title="search page">
						<img src="ico/search.svg"  type="image/svg+xml" alt='search' class="menu_ico">		</a>	
			<a href='pages/usr_cart.html' class="icon_link" title="client cart page">
						<img src="ico/cart.svg"  type="image/svg+xml" alt='client cart' class="menu_ico">
						<div class="cart_bage fnt_size_10 flex_centr"></div>	</a>
		</div>				
</header>
<div class="header_hoop blok_centr"> </div>
</div><!-- header_wrap -->
<slider>
   	<a href="pages/href_debug.htm" class="slider_pic_link slider_pic_link_pos1" title="Change old book on new">
		<div class="slider_pic_link_box slider_pic_link_box1">Change old book on new
		<img src="img/arrow.svg"  type="image/svg+xml" alt='Change old book on new' class="slider_pic_link_arrow slider_pic_link_arrow1"></div>
	</a>	
	<a href="pages/href_debug.htm" class="slider_pic_link slider_pic_link_pos2" title="top 100 books 2022">
		<div class="slider_pic_link_box slider_pic_link_box2">top 100 books 2022
		<img src="img/arrow.svg"  type="image/svg+xml" alt='top 100 books 2022' class="slider_pic_link_arrow slider_pic_link_arrow2"></div>
	</a>  
	<div class="sliderContainer blok_centr"></div>
	<div class="sliderSwitch"> 		</div>
</slider>
<main>
	<sidebar id='sidebar1'>		
			<div class="sidebarTextBlock">
			</div>
	</sidebar>
	<div class="goodsBlock">	
		<!-- content to be generated when user selection occur -->		
	</div>	
</main><div class="ldMoreBtnWrap"><button class='ldMoreBtn' id='loadMoreAncor'>Load More</button></div>

<footer>
		<div id="footer_blk"> footer block</div>
</footer>
</div><!-- container0 blok_centr -->
<script src="bshp_modules/Init00.js" type="text/javascript">  </script>

<script src="bshp_modules/slider.js" type="text/javascript">  </script>
<script src="bshp_modules/sidebar2.js" type="text/javascript"></script>

<script src='bshp_modules/rateStars.js' type="text/javascript"> </script> 
<script src='bshp_modules/buildCard.js' type="text/javascript"> </script>

<script src='bshp_modules/locbase_respns.js' type="text/javascript"></script>
<script src='bshp_modules/fetchReq.js' type="text/javascript"></script>
<script>
						/* main module */
'use strict';
const 
categorySelect = function () {	
	let runOnce = true, intervalID, lastCategory ={}, genLoader;
	const bookblk = cnst.doc0.querySelector('.goodsBlock'), loadMoreBtn = cnst.doc0.querySelector('.ldMoreBtn'),
	      zero = 0,		
//scrolls up to top when cards have been dealt
bookblkWidth = () =>{return getProp2(bookblk,'width');
},
scrUp = () => {
	let num, numThreshold;
	if (runOnce) {
		runOnce=false;
		intervalID = setInterval(()=>{
		num = cnst.doc0.querySelectorAll('.cardContainer').length;  numThreshold = cnst.cardQuantity-1;
		msgSrv({'scrUp cards':num});					
			if (num>numThreshold){
					clearInterval(intervalID);
					msgSrv({'scrUp scrollUp by':window.innerHeight});
					window.scrollBy(zero, -window.innerHeight);}
			},cnst.sto);
	};
},
bookBlockEmpty = ()  =>{if (bookblk.children.length) {return false;} else {return true;}},
loaderShow = (state=true) => {
	// bookblkWidth from loadMoreBtnHeight()
	const divider = 6, ringDim = bookblkWidth()/divider, 
	ringDimPX = plusPX(ringDim), brThknss =plusPX(ringDim/divider) ;
	if (state) {loadMoreBtn.style.display=cnst.none;
		    genLoader = putEl('loaderRing');		    
		    setProp(genLoader,{ 'display':cnst.blk,'height':ringDimPX, 'width':ringDimPX, 'borderWidth':brThknss, 
					'borderTop':brThknss+'solid mediumturquoise','margin':'0'});
		 if (bookBlockEmpty()) {bookblk.style.backgroundColor='gainsboro';bookblk.classList.add('flex_centr');
					bookblk.appendChild(genLoader);/* 1 */}
		 else { genLoader.style.margin='1% auto 10%';
	    		bookblk.appendChild(genLoader);	/* 2 */	window.scrollBy(zero, window.innerHeight);}
	}
	else {	 loadMoreBtn.style.display=cnst.blk;   
		 bookblk.removeChild(genLoader);
		 if (bookBlockEmpty()) {   bookblk.classList.remove('flex_centr'); 
		   			   bookblk.style.backgroundColor=cnst.es;	 	}
	};
},
//goods cards building preparation
cardDeal = (cardData,localData=false) => {
	
	  loaderShow(false);
	
    if (!bookBlockEmpty() && localData) {return;} 
    cardData = cardData.items;	
    for (let i=zero;i<cnst.cardQuantity;i++){
		const volInf = cardData[i].volumeInfo,
		      imgLinks = volInf.imageLinks,		      
		      searchInf = cardData[i].searchInfo,
		      volAuthors = volInf.authors,
		      saleInfo = cardData[i].saleInfo;		
		
		let authorCaption = cnst.es,cena = zero,		imageCoverURL =cnst.es,
	         		       annot = 'No annotation';
		if (imgLinks) {imageCoverURL = imgLinks.thumbnail};
 		if (searchInf) {if ('textSnippet' in searchInf) {annot = searchInf.textSnippet;}}
		if (saleInfo.saleability==='FOR_SALE') {cena = saleInfo.retailPrice.amount+' '+saleInfo.retailPrice.currencyCode;}
		if (volAuthors) {authorCaption=volAuthors[0];
			volAuthors.forEach ((i,n)=>{ if (n) {authorCaption=authorCaption+', '+i;}});
		};
		let ratingsCount = volInf.ratingsCount, averageRating = volInf.averageRating;
		if (!ratingsCount) {ratingsCount=zero;}    if (!averageRating) {averageRating=zero;}
	const cardContainer = putEl('cardContainer');
		bookblk.appendChild(cardContainer);

	buildCard(cardContainer, {
		'imageSrc':imageCoverURL, 
	 	'author':authorCaption,
	 	'caption':volInf.title,
		'averageRating':averageRating,
		'reviewCnt':ratingsCount,
	 	'annot':annot,
	 	'price':cena});
    };//for (let i=0;i<cnst.cardQuantity;i++)...
	scrUp();
},
loadMoreBtnHeight = () =>{
	const bblkWidth = bookblkWidth();
   	setProp(loadMoreBtn,{'height':plusPX(bblkWidth/15), 'fontSize':plusPX(bblkWidth/35)});
};
function categorySelect (category,indexPlus=false) {
	/* fires when sidebar category selected (call from sidebar2.js - category selection by user) */
	/* category: {'number':number,'name':String} */
 	if (!category) {category={'number':zero,'name':siList[zero]};}
	if (lastCategory != category) {bookblk.innerHTML=cnst.es; }

 	  loaderShow();

	setTimeout(()=>{fetchData(category.name,cardDeal,indexPlus);},cnst.loadDelay);
 		
lastCategory = category};
//cart_bage element content initial fill (Init00.js)
cartBage();
//initial category selection + sidebar state setting (sidebar2.js)
categorySelect(sbItemSel(0));
//load More Button
loadMoreBtnHeight();	loadMoreBtn.addEventListener('click',()=>{categorySelect(lastCategory,true);});
			window.addEventListener('resize',loadMoreBtnHeight);
return categorySelect;
}();
</script>
</body></html>
